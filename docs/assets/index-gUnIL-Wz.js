(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector(".hamburguesa"),t=document.getElementById("menu");n.addEventListener("click",()=>{const e=t.classList.toggle("activo");n.setAttribute("aria-expanded",e)}),t.querySelectorAll("a").forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("activo"),n.setAttribute("aria-expanded",!1)})}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(t.classList.remove("activo"),n.setAttribute("aria-expanded",!1))})});function A(){const n=document.getElementById("galeria-json");n&&fetch("data/gallery.json").then(t=>t.json()).then(t=>{n.innerHTML=t.map(e=>e.src.type==="image"?`
              <figure class="item"
                data-categoria="${e.category}"
                data-etiquetas="${e.tags.join(",")}"
                data-vistas="${e.views}"
                data-fecha="${e.createdAt}">
                
                <img 
                  src="${e.src.jpg}" 
                  srcset="${e.src.small} 600w, ${e.src.jpg} 1200w"
                  sizes="(max-width: 768px) 100vw, 50vw"
                  alt="${e.title}" 
                  width="${e.width}" 
                  height="${e.height}" 
                  loading="lazy">
                
                <figcaption>${e.title}</figcaption>
              </figure>
            `:`
              <figure class="item"
                data-categoria="${e.category}"
                data-etiquetas="${e.tags.join(",")}"
                data-vistas="${e.views}"
                data-fecha="${e.createdAt}">
                
                <video autoplay muted loop playsinline poster="${e.src.poster||""}">
                  <source src="${e.src.mp4}" type="video/mp4">
                </video>
                
                <figcaption>${e.title}</figcaption>
              </figure>
            `).join("")}).catch(t=>console.error("Error cargando galerÃ­a:",t))}function w(){const n=document.getElementById("galeria-json");if(!n)return;const t=document.querySelectorAll(".btn-filtro"),e=document.getElementById("buscar"),a=document.getElementById("ordenar");document.querySelector(".galeria-vacia");let r="todos",o="",i="reciente";function d(s){return s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function l(){const s=Array.from(n.querySelectorAll(".item"));let f=s.filter(c=>{const u=c.dataset.categoria.split(",").map(p=>p.trim().toLowerCase()),E=c.dataset.etiquetas.split(",").map(p=>p.trim().toLowerCase()),L=c.querySelector("figcaption").innerText,q=r==="todos"||u.includes(r.toLowerCase()),S=!o||d(L).includes(d(o))||E.some(p=>d(p).includes(d(o)));return q&&S});i==="az"?f.sort((c,u)=>c.querySelector("figcaption").innerText.trim().localeCompare(u.querySelector("figcaption").innerText.trim(),"es",{sensitivity:"base"})):i==="vistos"?f.sort((c,u)=>parseInt(u.dataset.vistas||"0",10)-parseInt(c.dataset.vistas||"0",10)):f.sort((c,u)=>new Date(u.dataset.fecha||"1970-01-01")-new Date(c.dataset.fecha||"1970-01-01")),s.forEach(c=>{f.includes(c)?c.style.display="inline-block":c.style.display="none"}),f.forEach(c=>n.appendChild(c))}t.forEach(s=>s.addEventListener("click",()=>{t.forEach(f=>f.classList.remove("activo")),s.classList.add("activo"),r=s.dataset.categoria,l()})),e.addEventListener("input",s=>{o=s.target.value,l()}),a.addEventListener("change",s=>{i=s.target.value,l()}),l()}function x(){const n=document.getElementById("promo-btn"),t=document.getElementById("promo-modal"),e=t.querySelector(".cerrar"),a=t.querySelector(".promo-contenido");let r=null;function o(){r=document.activeElement,t.classList.add("activo"),t.setAttribute("aria-hidden","false"),a.setAttribute("tabindex","-1"),a.focus(),d(t)}function i(){t.classList.remove("activo"),t.setAttribute("aria-hidden","true"),a.removeAttribute("tabindex"),r&&r.focus()}n.addEventListener("click",o),e.addEventListener("click",i),document.addEventListener("keydown",l=>{l.key==="Escape"&&t.classList.contains("activo")&&i()});function d(l){const s=l.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),f=s[0],c=s[s.length-1];l.addEventListener("keydown",u=>{u.key==="Tab"&&(u.shiftKey?document.activeElement===f&&(u.preventDefault(),c.focus()):document.activeElement===c&&(u.preventDefault(),f.focus()))})}}document.addEventListener("DOMContentLoaded",()=>{document.querySelector(".btn-arriba").addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})});let m,v,h=0;function g(n){m.forEach((t,e)=>{const a=t.querySelector("video");e===n?(t.classList.add("activo"),a&&(a.currentTime=0,a.play())):(t.classList.remove("activo"),a&&(a.pause(),a.currentTime=0)),v&&v[e]&&v[e].setAttribute("aria-selected",e===n?"true":"false")}),h=n}function y(){g((h+1)%m.length)}function b(){g((h-1+m.length)%m.length)}function $(){m=document.querySelectorAll(".slide");const n=document.querySelector(".flecha.izquierda"),t=document.querySelector(".flecha.derecha"),e=document.getElementById("puntos");!m.length||!e||(e.innerHTML="",m.forEach((a,r)=>{const o=document.createElement("button");o.setAttribute("role","tab"),o.setAttribute("aria-label",`Ir a la diapositiva ${r+1}`),o.setAttribute("aria-selected",r===0?"true":"false"),e.appendChild(o),o.addEventListener("click",()=>g(r))}),v=e.querySelectorAll("button"),t.addEventListener("click",y),n.addEventListener("click",b),m.forEach(a=>{const r=a.querySelector("video");r&&r.addEventListener("ended",y)}),g(0))}function k(n,t){const e=document.querySelector(n);if(!e)return;const a=e.querySelector(t);function r(o){if(!e.classList.contains("activo"))return;const i=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),d=i[0],l=i[i.length-1];o.key==="Tab"&&(o.shiftKey?document.activeElement===d&&(o.preventDefault(),l.focus()):document.activeElement===l&&(o.preventDefault(),d.focus())),o.key==="Escape"&&(e.classList.remove("activo"),e.setAttribute("aria-hidden","true"),a.focus())}document.addEventListener("keydown",r)}function C(n,t,e){const a=document.querySelector(n);if(!a)return;let r=0,o=0;a.addEventListener("touchstart",i=>{r=i.touches[0].clientX}),a.addEventListener("touchend",i=>{o=i.changedTouches[0].clientX;const d=o-r;Math.abs(d)>50&&(d<0?t():e())})}document.addEventListener("DOMContentLoaded",async()=>{await A(),w(),$(),x(),k("#promo-modal",".cerrar"),C("#slider",y,b)});
